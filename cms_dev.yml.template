version: "2"

services:
    cms-db:
        image: mysql:5.6
        volumes:
            - "./shared/db:/var/lib/mysql"
        restart: always
        environment:
            - MYSQL_DATABASE=cms
            - MYSQL_USER=cms
            - MYSQL_RANDOM_ROOT_PASSWORD=yes
        mem_limit: 1g
        env_file: config.env
    cms-xmr:
        image: xibosignage/xibo-xmr:release_1.8.0-rc2
        ports:
            - "9505:9505"
        restart: always
        mem_limit: 256m
        environment:
            - XMR_DEBUG: "true"
        env_file: config.env
    cms-web:
        image: xibosignage/xibo-cms:develop
        volumes:
            - "./shared/cms/web:/var/www/cms"
        restart: always
        links:
            - cms-db:mysql
            - cms-xmr:50001
        environment:
            - XMR_HOST=cms-xmr
        env_file: config.env
        ports:
            - "8080:80"
        mem_limit: 1g
